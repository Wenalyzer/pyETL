<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>信用卡活動登錄-國泰世華銀行</title>
    <meta name="description" content="國泰世華銀行 信用卡活動登錄">
    <meta name="keywords" content="國泰世華銀行,信用卡活動登錄">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="400">
    <meta http-equiv="cleartype" content="on">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui, user-scalable=0">
    <meta name="author" content="國泰世華銀行">
    <!--	Common CSS file /begin -->
    <link rel="shortcut icon" href="/promotion/Promotion/Promotion/images/favicon.ico?v=3wfjlk5air3LkLOGXrSB9C9Q8vbtzU2p4WHg5G98dkE">

    
    <!--AT-->
    <script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-P6JTTWL"></script><script async="" src="https://www.cathaybk.com.tw/cathaybk/web/js/launch-EN88f8719298e647dd91dbad89ef222833.min.js"></script>
    <!-- CelebrusInsert code-->
    <script type="text/javascript" src="https://www.cathaybk.com.tw/celebrusInsert.js"></script>    

    <link rel="stylesheet" href="/promotion/Promotion/Promotion/css/template_for_all.css?v=RUZv8MmJ6UBfyrtrIDqOrZwXKdDc8SiliKRR-SjR1ic">

    
<link href="/promotion/Promotion/Promotion/css/nps.css" rel="stylesheet">


    <!-- Google Tag Manager -->
        <script>
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-P6JTTWL');
        </script><script src="/cathaybk/web/js/7d408cdaa164/EP6989456eab6f4f618b15e82840ffd69b/AppMeasurement.min.js" async=""></script><style id="at-makers-style" class="at-flicker-control">
.mboxDefault {visibility: hidden;}
</style>
    <!-- End Google Tag Manager -->


<style>
        #external-player-toast-div {
            z-index: 999999999;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translate(-50%, 0);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 14px;
            padding: 10px 20px;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.5s ease;
            display: none;
            letter-spacing: 1px;
        }
        #external-player-loading-div {
            z-index: 999999999;
            display: none;
            position: fixed;
            bottom: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0);
        }
        #external-player-loading-div div {
            width: 50px;
            height: 50px;
            background-color: rgba(74, 144, 226, 1);
            border-radius: 0;
            -webkit-animation: sk-rotateplane 1.2s infinite ease-in-out;
            animation: sk-rotateplane 1.2s infinite ease-in-out;
        }
        @-webkit-keyframes sk-rotateplane {
            0% {
                -webkit-transform: perspective(120px)
            }
            50% {
                -webkit-transform: perspective(120px) rotateY(180deg)
            }
            100% {
                -webkit-transform: perspective(120px) rotateY(180deg) rotateX(180deg)
            }
        }
        @keyframes sk-rotateplane {
            0% {
                transform: perspective(120px) rotateX(0deg) rotateY(0deg);
                -webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg)
            }
            50% {
                transform: perspective(120px) rotateX(-180deg) rotateY(0deg);
                -webkit-transform: perspective(120px) rotateX(-180deg) rotateY(0deg)
            }
            100% {
                transform: perspective(120px) rotateX(-180deg) rotateY(-180deg);
                -webkit-transform: perspective(120px) rotateX(-180deg) rotateY(-180deg);
            }
        }
        #external-player-button-div {
            z-index: 999999997;
            position: fixed;
            display: none;
            align-items: center;
            width: auto;
            height: auto;
            left: 9px;
            bottom: 160px;
            padding: 5px;
            border: 3px solid rgba(0, 0, 0, 0);
            border-radius: 5px;
            cursor: move;
            gap: 10px;
            background-color: rgba(0, 0, 0, 0);
            min-width: 50px;
            min-height: 50px;
        }
        #external-player-button-div button {
            color: white;
            font-size: 20px;
            font-weight: bold;
            width: 50px;
            height: 50px;
            outline: none;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            background-size: cover;
            background-color: rgba(0, 0, 0, 0);
            transition: opacity 0.5s ease, visibility 0s linear 0.5s;
        }
        #external-player-button-div:hover {
            background-color: rgb(255, 255, 255, 0.3) !important;
        }
        #external-player-button-div:hover button {
            visibility: visible !important;
            transition: opacity 0.5s ease, visibility 0s;
        }
        #external-player-button-div button:hover {
            transform: scale(1.06);
            box-shadow: 0px 0px 16px #e6e6e6;
        }
        #external-player-setting-button {
            visibility: hidden;
            position: absolute;
            right: -12px !important;
            top: -12px !important;
            width: 25px !important;
            height: 25px !important;            
            background-image: url('data:image/svg+xml,<svg t="1731846507027" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4281" width="16" height="16"><path d="M616.533333 512.128c0-25.6-9.941333-49.536-28.16-67.669333a95.744 95.744 0 0 0-67.84-28.074667c-25.685333 0-49.706667 9.984-67.925333 28.074667a95.146667 95.146667 0 0 0-28.16 67.669333c0 25.6 10.069333 49.578667 28.16 67.712 18.218667 18.048 42.24 28.074667 67.925333 28.074667 25.642667 0 49.664-10.026667 67.84-28.074667 18.218667-18.133333 28.16-42.112 28.16-67.712z m-202.112 352.896l48-55.978667a309.290667 309.290667 0 0 0 99.029334 0l48 55.978667a27.52 27.52 0 0 0 30.208 7.978667l2.218666-0.768a380.074667 380.074667 0 0 0 118.186667-68.138667l1.834667-1.536a27.434667 27.434667 0 0 0 8.106666-30.037333l-24.746666-69.546667a298.666667 298.666667 0 0 0 49.322666-85.205333l72.874667-13.44a27.477333 27.477333 0 0 0 22.058667-22.101334l0.426666-2.304a384.64 384.64 0 0 0 0-135.936l-0.426666-2.304a27.477333 27.477333 0 0 0-22.058667-22.058666l-73.216-13.525334a302.293333 302.293333 0 0 0-49.194667-84.650666l25.002667-70.016a27.306667 27.306667 0 0 0-8.149333-30.037334l-1.834667-1.536a383.018667 383.018667 0 0 0-118.186667-68.138666l-2.218666-0.768a27.605333 27.605333 0 0 0-30.208 7.936l-48.512 56.661333a302.592 302.592 0 0 0-97.834667 0L414.592 159.146667a27.52 27.52 0 0 0-30.208-7.978667l-2.218667 0.768a381.056 381.056 0 0 0-118.186666 68.138667l-1.834667 1.536a27.434667 27.434667 0 0 0-8.106667 30.037333l24.96 69.973333a296.192 296.192 0 0 0-49.194666 84.693334l-73.216 13.525333a27.477333 27.477333 0 0 0-22.058667 22.058667l-0.426667 2.304a382.592 382.592 0 0 0 0 135.936l0.426667 2.304c2.048 11.221333 10.794667 20.053333 22.058667 22.101333l72.874666 13.44a300.672 300.672 0 0 0 49.365334 85.248l-24.832 69.504a27.306667 27.306667 0 0 0 8.149333 30.037333l1.834667 1.536a383.018667 383.018667 0 0 0 118.186666 68.138667l2.218667 0.768a27.733333 27.733333 0 0 0 30.037333-8.149333z m-44.8-352.853333A150.656 150.656 0 0 1 520.533333 361.642667a150.656 150.656 0 0 1 150.869334 150.442666A150.656 150.656 0 0 1 520.533333 662.613333a150.656 150.656 0 0 1-150.912-150.485333z" fill="rgba(74, 144, 226, 1)" p-id="4282"></path></svg>');
        }
        #external-player-setting-iframe {
            z-index: 999999998;
            position: fixed;
            width: 1000px;
            max-width: 100%;
            height: 500px;
            max-height: 90%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: none;
            border-radius: 5px;
            box-shadow: 0 0 16px rgba(0, 0, 0, 0.6);
            background-color: #fff;
            display: none;
        }
    </style></head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P6JTTWL"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="loadingElement">
        <span>LOADING</span>
        <div class="loadingBall">
        </div>
    </div>
    <div class="modal-mask"></div>

    
<!-- nps  -->
<div class="m_bg nps_m_bg"></div>
<div class="m_smart_box nps_m_smart_box">
    <div class="m_smart_in">
        <div class="circCont nps_circCont"><button class="circle scaleUp nps_circle"></button></div>
        <iframe src="https://survey.cathaybk.com.tw/s/wep7R?ssn0=8ddc267101282a684ab2f440d7e2b93c9378ac68e7214e4652c04b902dbd103e&amp;ssn6=PC&amp;ssn7=Chrome&amp;ssn8=Windows 10.0" frameborder="0"></iframe>
    </div>
</div>
<!-- nps end  -->

    <div class="container">
        <div class="main">
            <header class="header clearfix">
                <a href="https://www.cathaybk.com.tw/cathaybk/" class="header__logo"></a>
                <div class="header__title">
                    信用卡活動登錄
                </div>
            </header>

            



<div class="tabbox">
    <!-- tab-->
    <div class="stepWrap">
        <div class="wrap">
            <ul class="tab">
                <li class="active">登錄活動</li>
                <li class="signed-campaign-tab">已登錄活動</li>
            </ul>
        </div>
    </div>
<div class="cubenps">
    <div class="wrap">
        <div class="cubenps_box d-flex justify-content-center ">
            <div class="icon_nps_box">
                    <div class="icon_nps icon_01"></div>
                    <div class="icon_nps icon_01"></div>
                    <div class="icon_nps icon_01"></div>
            </div>
                <div class="box__text">
                    <div class="box_title">幫我們的服務打個分數吧</div>
                    我們非常樂意聽取您的意見，<br class="mobileshow">只要花您30秒會讓我們服務更好！
                </div>
                <div class="actionArea">
                        <a class="_btn nps_score_btn" href="javascript:void(0)">
                            <span> 我要打分數</span>
                        </a>
                </div>

        </div>
    </div>
</div>
    <div class="tab-content-wrapper">
        <div id="tab-campaign" class="tab-content">
            <div class="textin">
                <p class="color_Blaze_Orange">登錄各項刷卡優惠活動前請詳閱活動辦法及注意事項，若完成登錄活動即表示您已了解並同意相關活動規則。</p>
                <div class="table-responsive">
                    <div class="css-table tablelogin" style="display:table;">
                        <div class="thead">
                            <div class="tr">
                                <div class="th textCenter">活動名稱</div>
                                <div class="th textCenter">登錄狀態</div>
                                <div class="th textCenter">狀態查詢</div>
                            </div>
                        </div>
                        <div class="tbody">
                                <div class="tr">
                                    <div class="td wtitle">
                                            <a href="https://www.cathay-cube.com.tw/content/cub-aem-cs/zh-tw/cathaybk/personal/event/overview/credit-card/online-shopping/202504/shopee202504_2" target="_blank" class="link campaign-name">
                                                蝦皮購物 4月狂購盛典
(4/5~4/18)
                                            </a>
                                        <p class="campaign-desc" style="display:none;">2025/4/5~2025/4/18於蝦皮購物刷國泰世華卡消費達以下門檻，登錄享： 1. 單筆消費(含一次付清及分期付款)滿NT$10,000(含)以上，贈NT$600刷卡金或小樹點(信用卡) 2. 單筆消費且須分期付款(3、6、24)滿NT$25,000(含)以上，贈NT$2,000刷卡金或小樹點(信用卡) *兩門檻合計限量登錄500名，額滿即關閉。</p>
                                        <p class="campaign-memo" style="display:none;">1.參加本活動之持卡人須於2025/4/21 當日16:00至4/30 23:59透過本行官網登錄專區或國泰優惠CUBE Rewards APP完成活動登錄始符合資格(限以正卡人資料登錄)，兩門檻合計限量登錄500名，登錄名額額滿將提前關閉登錄系統。2. 本活動商務卡、LINE PAY交易、街口支付及shopeeads (蝦皮加值服務中心)等任何形式廣告購買消費不適用，Debit金融卡不適用分期交易。3.正附卡消費合併計算，每正卡戶限回饋乙次，最高回饋NT$2,000刷卡金或等值小樹點(信用卡)，蝦皮購物同月份之刷卡促刷活動每正卡戶限擇優回饋乙次。4.活動結束後之登錄結果查詢，請至國泰世華銀行官網登錄專區查詢。5.活動詳情請上官網查詢，優惠提供期間倘因不可歸責於本行之事由，本行得變更</p>
                                    </div>
                                    <div class="td tdbtnw">
                                        <div class="actionArea">
                                                <a href="javascript:void(0)" class="btn btngray">
                                                    <span class="onebox">已額滿</span>
                                                </a>
                                        </div>
                                    </div>
                                    <div class="td textCenter">
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-content">
            <div class="textin">
                    <p>以下提供您查詢進行中及近3個月內已結束之刷卡優惠登錄活動</p>
                    <div id="table-signed" class="table-responsive fixed-solution has-collapse">
                        <table cellspacing="0" class="table table-small-font table-bordered table-even detailTable table--dataTh">
                            <thead>
                                <tr>
                                    <th class="textCenter">活動名稱</th>
                                    <th class="textCenter">登錄序號</th>
                                    <th class="textCenter">登錄日期</th>
                                    <th class="textCenter">詳情</th>
                                </tr>
                            </thead>
                            <tbody>
                                    <tr>
                                        <td data-title="活動名稱" class="textLeft wtitle">
                                            <p class="NOlink">台塑聯名卡加油滿額登錄送</p>
                                        </td>
                                        <td data-title="登錄序號" class="textCenter">
                                            <span>0071622</span>
                                        </td>
                                        <td data-title="登錄日期" class="textCenter">
                                            <span>2025/04/23</span>
                                        </td>
                                        <td data-title="詳情">
                                            <span><div class="detail-btn"></div>  </span>
                                        </td>
                                    </tr>
                                    <tr class="collapse">
                                        <td colspan="4">
                                            <div class="detail-wrapper">
                                                <div class="detail-block">
                                                    活動期間，當月週日至週五(週六加油消費不列入計算)，持台塑聯名卡於台亞、福懋、西歐、速邁樂加油中心(外島不適用)及標示有【動能精靈】之加油站加油，月累積滿NT$2,000(含)以上，送100元加油金。
                                                    <br>
                                                    1.活動期間：2025/4/1起至2025/6/30止。2.參加本活動須於指定加油站刷台塑聯名卡，且持卡人於活動期間2025/4/1至2025/6/30透過本行官網登錄專區、國泰優惠CUBE Rewards App完成登錄（限以正卡人資料登錄）。3.本活動以登錄當月起的各月指定加油站累積消費金額計算，正附卡消費合併計算，每戶每月最高回饋上限為100元加油金。4.活動詳情請參閱本行官網。
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td data-title="活動名稱" class="textLeft wtitle">
                                            <p class="NOlink">簽帳金融卡指定通路現金回饋(適用對象:限25歲(含)以下用戶)</p>
                                        </td>
                                        <td data-title="登錄序號" class="textCenter">
                                            <span>0065742</span>
                                        </td>
                                        <td data-title="登錄日期" class="textCenter">
                                            <span>2025/04/23</span>
                                        </td>
                                        <td data-title="詳情">
                                            <span><div class="detail-btn"></div>  </span>
                                        </td>
                                    </tr>
                                    <tr class="collapse">
                                        <td colspan="4">
                                            <div class="detail-wrapper">
                                                <div class="detail-block">
                                                    完成活動登錄後，當月持簽帳金融卡綁定LINE Pay消費享1.5%現金回饋無上限；蝦皮購物、麥當勞享3%現金回饋！（每戶每月回饋上限為新台幣150元）
                                                    <br>
                                                    1.本活動須於2025/1/1 16:00至2025/6/30 23:59透過本行官網登錄專區、國泰優惠APP完成活動登錄始符合資格。
2.活動登錄及相關限制說明請上本行網站查詢。本行保留隨時變更及終止本活動之權利，並於本行官網公告之；若有其他未盡事宜，悉依本行相關規定或解釋為準。
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td data-title="活動名稱" class="textLeft wtitle">
                                            <p class="NOlink">刷eTag聯名卡 享eTag自動儲值5%現金回饋</p>
                                        </td>
                                        <td data-title="登錄序號" class="textCenter">
                                            <span>0428301</span>
                                        </td>
                                        <td data-title="登錄日期" class="textCenter">
                                            <span>2024/06/18</span>
                                        </td>
                                        <td data-title="詳情">
                                            <span><div class="detail-btn"></div>  </span>
                                        </td>
                                    </tr>
                                    <tr class="collapse">
                                        <td colspan="4">
                                            <div class="detail-wrapper">
                                                <div class="detail-block">
                                                    2025/1/4~2025/12/31，eTag聯名卡當月新增一般消費達NT$3,000並完成登錄，該月eTag自動儲值金享5%現金回饋，每月每戶回饋上限NT$300。
                                                    <br>
                                                    1.本活動適用卡別：eTag聯名卡。 當月新增一般消費達NT$3,000並完成登錄，方可享有eTag自動儲值5%現金回饋活動資格，每一信用卡ID每月限回饋乙次，每月每戶現金回饋上限NT$300，係以本行信用卡歸戶下所有eTag帳戶之自動儲值金合併計算。※詳細優惠內容及限制請參閱本行網站說明，活動期間倘因不可歸責於本行之事由，本行得變更或終止活動，並於本行網站上公告。
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                            </tbody>
                        </table>
                    </div>
                    <!--<div class="table-responsive mb-card has-collapse">
                        <table cellspacing="0" class="table detailTable table--dataTh">
                            <thead>
                                <tr>
                                    <th class="textCenter">活動名稱</th>
                                    <th class="textCenter">登錄序號</th>
                                    <th class="textCenter">登錄日期</th>
                                    <th class="textCenter">詳情</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td data-title="活動名稱" class="textLeft ">
                                        <p class="NOlink">高鐵購票刷指定信用卡，登錄享筆筆10%回饋</p>
                                    </td>
                                    <td data-title="登錄序號" class="textCenter">
                                        <span>0050106</span>
                                    </td>
                                    <td data-title="登錄日期" class="textCenter">
                                        <span>2020/11/16</span>
                                    </td>
                                    <td data-title="詳情">
                                        <span><div class="detail-btn open"></div>  </span>
                                    </td>
                                </tr>
                                <tr class="collapse show">
                                    <td colspan="4">
                                        <div class="detail-wrapper">
                                            <div>你好</div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td data-title="活動名稱" class="textLeft ">
                                        <p class="NOlink">KOKO搭捷運/公車滿20次享回饋</p>
                                    </td>
                                    <td data-title="登錄序號" class="textCenter">
                                        <span>0090320</span>
                                    </td>
                                    <td data-title="登錄日期" class="textCenter">
                                        <span>2019/07/09</span>
                                    </td>
                                    <td data-title="詳情">
                                        <span><div class="detail-btn open"></div>  </span>
                                    </td>
                                </tr>
                                <tr class="collapse show">
                                    <td colspan="4">
                                        <div class="detail-wrapper">
                                            <div class="detail-block">
                                                單筆學費NT$6萬(含)以上，登錄享等值NT$220回饋。
                                                [依繳費卡別回饋：里程為620哩；紅利為3,666點；多利金/加油金/蝦幣/現金回饋為NT$220]
                                                單筆學費NT$20萬(含)以上，登錄享等值NT$1,200回饋。
                                                [依繳費卡別回饋：里程為5,200哩；紅利為20,000點；多利金/加油金/蝦幣/現金回饋為NT$1,200]
                                                ※為提供更佳之點數使用體驗，自2021/6/27起，本行「紅利點數」名稱更名為「小樹點(信用卡)」，同時變更點數價值為1點等值NT$1。故原學費消費之紅利點數回饋，將於2021年8月帳單改為回饋「小樹點(信用卡)」，單筆學費滿NT$6萬/NT$20萬之回饋，分別為小樹點(信用卡)220點/1200點。
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>-->
            </div>
        </div>
    </div>
    <!-- tab end-->
</div>


<!-- lightbox02 登錄結果  -->
<div class="modal" data-popup="lightbox02">
    <div class="modaltitle">登錄結果</div>
    <div class="modalclose"></div>
    <div class="iconIMG">
        <img src="/promotion/Promotion/Promotion/images/illustrator/thank-you.svg?v=1TNpnZeOUNKyNpcQr-PpDNVFKi6mrZmJw0_24SEDcmU">
    </div>
    <p class="textCenter">
        <span id="result-message"></span>
        <br>
        <span id="result-sign-up-number" class="color_Orange"></span>
    </p>
    <div class="btn-box">
        <button type="button">關閉頁面</button>
    </div>
</div>

<!-- 登錄失敗 -->

<div class="modal" data-popup="errorlightbox">
    <div class="modaltitle">登錄失敗</div>
    <div class="modalclose"></div>
    <div class="iconIMG">
        <img src="/promotion/Promotion/Promotion/images/illustrator/system-error.png?v=rVf5JDfW-jf0eGhdmK7UHzzBKWRuXgHBnrwmwy8jbz4">
    </div>
    <p class="textCenter">
        系統忙碌中，請稍後再試。
    </p>
    <div class="btn-box">
        <button type="button">關閉頁面</button>
    </div>
</div>

<!-- 登錄失敗2 -->

<div class="modal" data-popup="errorlightboxOnhottime">
    <div class="modaltitle">Oops!</div>
    <div class="modalclose"></div>
    <div class="iconIMG">
        <img src="/promotion/Promotion/Promotion/images/illustrator/system-error.png?v=rVf5JDfW-jf0eGhdmK7UHzzBKWRuXgHBnrwmwy8jbz4">
    </div>
    <p class="textCenter">
        目前人潮眾多，請持續點擊「登錄」按鈕，嘗試登錄。
    </p>
    <div class="btn-box">
        <button type="button">關閉頁面</button>
    </div>
</div>


<!--登入失敗 end -->
<!-- lightbox03 好禮選擇 -->

<!-- lightbox04 好禮寄送查詢結果 -->

<form method="post" id="form-hidden" action="/promotion/promotion/CreditCard/SignCampaign">
    <input type="hidden" name="CampaignId">
    <input type="hidden" name="ProjectType">
    <input type="hidden" name="CampaignSeq">
<input name="__RequestVerificationToken" type="hidden" value="CfDJ8NTY5oKY_vFOhKUE2AiseQCQizWM-dQI_oKf5FI_NU7rF8n7oO0tni4AfF4GaJ3vqJ8b8E5KR-ikS3hD8T0N2bDUrMVp76ADPjJuqRb-LWqqLKpWe3RH7pB4MJcyRieEE4VZ_dPK1pE8zjnGU_He41Y"></form>



        </div>

        

        <footer class="footer">
            <div class="wrap">
                <div class="footer__warning">
                    <div class="footer__left">
                        <div>謹 慎 理 財</div>
                        <div>信 用 無 價</div>
                    </div>
                    <div class="footer__right">
                        信用卡暨預借現金之各級別循環信用年利率為6.75％~15％(依本行信用評分制度定期評估，循環利率之基準日為104年9月1日)。預借現金手續費：預借現金金額乘以3％加上新臺幣150元或美元5元，其他相關費用係依本行網站公告。
                    </div>
                </div>
            </div>
            <div class="footer__copyright">©國泰世華商業銀行股份有限公司</div><a class="gotop" href="javascript:void(0)"></a>
        </footer>
    </div>
    <script src="/promotion/Promotion/lib/jquery/dist/jquery.min.js?v=9_aliU8dGd2tb6OSsuzixeV4y_faTqgFtohetphbbj0"></script><script>
function getCeleCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}
function setCeleCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

  var cele = "";
if(document.cookie.split('cubcsapersisted=')[1]!=undefined){
	cele = document.cookie.split('cubcsapersisted=')[1].split('null_')[1].split('_')[1];
}
  var visitor = Visitor.getInstance("B877A5DB584931AC0A495EAA");

  if(getCeleCookie("setCele") != cele){
   setCeleCookie("setCele", cele,30);
  }
   visitor.setCustomerIDs({
      "celebrus_id":{
          "id":cele,
          "authState":Visitor.AuthState.AUTHENTICATED
       },
       "celebrus_id_DMP":{
          "id":cele,
          "authState":Visitor.AuthState.AUTHENTICATED
       }
   });


</script><script>
/**
 * 利用國泰官網的URL來取得對應的mbox
 * @param {*} url 目前所在URL
 * @returns 回傳對應mbox
 */
function getMbox(url) {
    var upperURL = url.toUpperCase();
    var SpecificURL = ['/CATHAYBK/PERSONAL/CREDIT-CARD/',
        '/CATHAYBK/PERSONAL/EXCHANGE/',
        '/CATHAYBK/PERSONAL/LOAN/',
        '/CATHAYBK/PERSONAL/INSURANCE/',
        '/CATHAYBK/PERSONAL/INVESTMENT/',
        '/CATHAYBK/PERSONAL/WEALTH/'];
    var urlnotparameter = location.pathname.toUpperCase();
    upperURL = upperURL.split("?")[0]; //過濾掉參數
    /** 比較前先刪除 # 的參數 */
    upperURL = upperURL.split("#")[0];
    if (SpecificURL.indexOf(urlnotparameter) > -1) {
        if (location.search.toUpperCase().indexOf('?DEV=MOBILE') > -1) { //但如果有手機模式參數，再把他加回去
            upperURL = upperURL + location.search.toUpperCase();
        }
    }
    var upperWebsiteURL = websiteURL.toUpperCase(); //不含路徑的乾淨網址
    /** 開始配對URL，並給予對應的mbox */
    switch (upperURL) {
        //[新官網] 活動專區新增 mbox 利用 # 來分賴種類
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/EVENT/OVERVIEW/":
            return {
                MBOXNAME: "Activity_Card1#Activity_Card2#Activity_Loan1#Activity_Loan2#Activity_Invest1#Activity_Invest2#Activity_Insurance1#Activity_Insurance2#Activity_Deposite1#Activity_Deposite2#Activity_Digital1#Activity_Digital2",
                OFFERNUM: 1
            }
        //[新官網] 首頁新增mbox 
        case upperWebsiteURL + "/CATHAYBK/HOME":
        case upperWebsiteURL + "/CATHAYBK/":
        case upperWebsiteURL + "/CATHAYBK":
            return {
                MBOXNAME: "homewelcome#homesearch1#homefunction1#homefunction2#homefunction3#homefunction4#homead1#homead2#homead3#homead4#homesearch2",
                OFFERNUM: 1
            };
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/LOAN/":
            return {
                MBOXNAME: "webproduct1",
                OFFERNUM: 3
            };
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/INSURANCE/":
            return {
                MBOXNAME: "webproduct1",
                OFFERNUM: 3
            };
        // 基金． 投資首頁
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/INVESTMENT/":
            return {
                MBOXNAME: "webfundhome1",
                OFFERNUM: 1
            };
        // 國泰官網測試環境-基金． 投資首頁
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/INVESTMENTS/":
            return {
                MBOXNAME: "webfundhome1",
                OFFERNUM: 1
            };
        // 基金_話題商品
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/INVESTMENT/FUND/":
            return {
                MBOXNAME: "webfundproduct1",
                OFFERNUM: 1
            };
        // 財富管理首頁
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/WEALTH/":
            return {
                MBOXNAME: "webwealthhome1",
                OFFERNUM: 1
            };
        case upperWebsiteURL + "/CATHAYBK/PERSONAL/LOAN/?DEV=MOBILE":
            return {
                MBOXNAME: "mwebproduct1",
                OFFERNUM: 2
            };
        case upperWebsiteURL + "/MYBANK/QUICKLINKS/CUSTOMIZED/INDEX":
            return {
                MBOXNAME: "1050forall",
                OFFERNUM: 3
            };
        default:
            break;
    }
}
</script><script>
var websiteURL = window.location.protocol + "//" + window.location.hostname; //現在所在網址，不包含路徑
var offers = []; //置換的主要offer陣列
var suboffers = []; //置換的次要offer陣列
var usedoffer = "";
var useditem = "";
var refPageName = "refPageName=" + window.document.title;
var requestMbox = getMbox(location.href); // getMbox回傳的mbox字串，多個mbox會用#區分
var multipleMbox = false;
var duplicateOffer = false;
var newWebOffers = {}; // 新官網因為有很多個mbox(舊的最多只支援2個mbox)，這邊用物件來判斷
var observerObject = {}; // 新官網 活動專區的 區塊監聽 MutationObserver 物件

/**
 * 確認值是否為空，空值回傳true
 * @param {*} val 確任的值
 * @returns 回傳true或false，空值回傳true
 */
function isEmpty(val) {
    return (val === undefined || val == null || val.length <= 0) ? true : false;
}

/**
 * 新增class的函式
 * @param {*} elements 選擇要新增的對象元素
 * @param {*} classname 要新增的class名稱
 * @returns 
 */
function addClass(elements, classname) {
    if (!elements) {
        return;
    }
    if (typeof (elements) === 'string') {
        elements = document.querySelectorAll(elements);
    } else if (elements.tagName) {
        elements = [elements];
    }
    for (var i = 0; i < elements.length; i++) {
        if ((' ' + elements[i].className + ' ').indexOf(' ' + classname + ' ') < 0) {
            elements[i].className += ' ' + classname;
        }
    }
}

/**
 * 移除class的函式
 * @param {*} elements 
 * @param {*} classname 
 * @returns 
 */
function removeClass(elements, classname) {
    if (!elements) {
        return;
    }
    if (typeof (elements) === 'string') {
        elements = document.querySelectorAll(elements);
    } else if (elements.tagName) {
        elements = [elements];
    }
    var reg = new RegExp('(^| )' + classname + '($| )', 'g');
    for (var i = 0; i < elements.length; i++) {
        elements[i].className = elements[i].className.replace(reg, ' ');
    }
}

/**
 * 確認是否為手機裝置的函式
 * 舊程式碼判斷是用navigator.userAgentData.mobile(檢查工具無法測試，所以先寫著放) 
 * @returns 回傳true或false，手機裝置會回傳true
 */
function detectMob() {
    const toMatch = [
        /Android/i,
        /webOS/i,
        /iPhone/i,
        /iPad/i,
        /iPod/i,
        /BlackBerry/i,
        /Windows Phone/i
    ];
    return toMatch.some((toMatchItem) => navigator.userAgent.match(toMatchItem)) || navigator.userAgentData.mobile;
}

/**
 * 為連結URL加上mbox名稱及refPageName在後面的參數，紀錄連結是從哪個mbox進入
 * @param {*} replaceLink 連結URL
 * @param {*} appenMboxName 後面要加上的mbox名稱參數
 * @returns 回傳加完後結果
 */
function getReplaceLink(replaceLink, appenMboxName) {
    var sharptxt = "";
    var connectText = "?";
    if (replaceLink.indexOf('?') >= 0) {
        connectText = "&";
    }
    if (replaceLink.indexOf('#') >= 0) {
        sharptxt = replaceLink.substring(replaceLink.indexOf('#'), replaceLink.length);
        var replaceLinksubshartp = replaceLink.substring(0, replaceLink.indexOf('#'));
        replaceLink = replaceLinksubshartp + connectText + refPageName;
    } else {
        replaceLink = replaceLink + connectText + refPageName;
    }
    replaceLink = replaceLink + "&MBOXNAME=" + appenMboxName + sharptxt;
    return replaceLink;
}

/**
 * [新官網] 為首頁及Header熱門推薦按鈕連結加參數的函式
 * 帶入參數有 q、kwtype、src 再加原本的 refPageName、MBOXNAME
 * @param {*} link 要加參數的連結URL
 * @param {*} kwType kwtype參數的值
 * @param {*} source src參數的值
 * @param {*} buttomName 按鈕名稱 q參數的值
 * @param {*} mboxName MBOXNAME的參數
 * @returns 回傳加參數後結果
 */
function addLinkParams(link, kwType, source, buttonName, mboxName) {
    var sharptxt = "";
    var connectText = "?";
    // 如果連結含有 ?
    if (link.indexOf('?') >= 0) {
        connectText = "&";
    }
    // 如果連結含有 #
    if (link.indexOf('#') >= 0) {
        sharptxt = link.substring(link.indexOf('#'), link.length);
        var replaceLinksubshartp = link.substring(0, link.indexOf('#'));
        link = replaceLinksubshartp + connectText;
    } else {
        link = link + connectText;
    }
    link = link + "q=" + buttonName + "&kwtype=" + kwType + "&src=" + source + "&" + refPageName + "&MBOXNAME=" + mboxName + sharptxt;
    return link;
}

/**
 * [新官網] 數位服務版位置換1~4
 * @param {*} mbox mbox名稱
 * @param {*} index 置換數位區塊的index 0~3
 * @param {*} subBtnIdx 如果有副按鈕，副按鈕的index 0~2，預設為null
 */
function replacedHomeFunction(mbox, index, subBtnIdx = null) {
    /** 如果 offer 的 key 名稱有修改的話 可修改此處 */
    var offerKeyName = {
        tabText: "Tab Text",
        titleLine: "Title Line",
        descriptionLine: "Description Line",
        image: "Image",
        buttomText: "Button Text",
        buttonLink: "Button Link",
        subButtonText: "Sub Button Text",
        subButtonLink: "Sub Button Link"
    }
    /** 數位服務1~4 選擇器 */
    /** 標籤 */
    var homeFunctionTab = document.querySelectorAll(".cubre-m-indexTab__btn p")[index];
    /** 圖片 */
    var homeFunctionImg = document.querySelectorAll(".cubre-m-indexGraphic.-sliderTab .cubre-m-indexGraphic__pic>img")[index];
    /** 主標題 */
    var homeFunctionMainText = document.querySelectorAll(".cubre-m-indexGraphic.-sliderTab .cubre-m-indexGraphic__title")[index];
    /** 副標題 */
    var homeFunctionSubText = document.querySelectorAll(".cubre-m-indexGraphic.-sliderTab .cubre-o-textContent span, .cubre-m-indexGraphic__text .cubre-o-textContent p")[index];
    /** 主按鈕 */
    var homeFunctionButton = document.querySelectorAll(".cubre-m-indexGraphic.-sliderTab a#lnk_ButtonLink1")[index];
    /** 次按鈕 */
    var homeFunctionSubButton = document.querySelectorAll(".cubre-m-indexGraphic.-sliderTab a#lnk_ButtonLink2")[subBtnIdx];
    /** 取得物件裡對應的offer */
    var replacedOfferHtml = newWebOffers[mbox][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
    var offer = JSON.parse(replacedOfferHtml);
    /** 置換按鈕及防呆機制 */
    if (homeFunctionButton && offer[offerKeyName.buttonLink] && offer[offerKeyName.buttomText]) {
        var replaceLink = getReplaceLink(offer[offerKeyName.buttonLink], mbox);
        homeFunctionButton.href = replaceLink;
        homeFunctionButton.innerText = offer[offerKeyName.buttomText];
    }
    /** 置換主標題及防呆機制 */
    homeFunctionMainText && offer[offerKeyName.titleLine] ? homeFunctionMainText.innerText = offer[offerKeyName.titleLine] : null;
    /** 置換副標題及防呆機制 */
    homeFunctionSubText && offer[offerKeyName.descriptionLine] ? homeFunctionSubText.innerText = offer[offerKeyName.descriptionLine] : null;
    /** 置換標籤及防呆機制 */
    homeFunctionTab && offer[offerKeyName.tabText] ? homeFunctionTab.innerText = offer[offerKeyName.tabText] : null;
    /** 置換圖片及防呆機制 */
    homeFunctionImg && offer[offerKeyName.image] ? homeFunctionImg.src = offer[offerKeyName.image] : null;
    /** 如果有副按鈕，置換副按鈕 */
    if (homeFunctionSubButton && subBtnIdx !== null && offer[offerKeyName.subButtonText] && offer[offerKeyName.subButtonLink]) {
        replaceLink = getReplaceLink(offer[offerKeyName.subButtonLink], mbox);
        homeFunctionSubButton.innerText = offer[offerKeyName.subButtonText];
        homeFunctionSubButton.href = replaceLink;
    } else if (offer[offerKeyName.subButtonText] && offer[offerKeyName.subButtonLink]) {
        console.log(mbox + " has " + offerKeyName.subButtonText + "/" + offerKeyName.subButtonLink + ",But No Element Found!");
    }

}


/**
 * [新官網] 季節活動版位置換1~4
 * @param {*} mbox mbox名稱
 * @param {*} index 置換數位區塊的index 0~3
 * @param {*} subBtnIdx 如果有副按鈕，副按鈕的index 0~2，預設為null
 */
function replacedHomeAd(mbox, index, subBtnIdx = null) {
    /** 如果 offer 的 key 名稱有修改的話 可修改此處 */
    var offerKeyName = {
        tabText: "Tab Text",
        titleLine: "Title Line",
        descriptionLine: "Description Line",
        image: "Image",
        buttomText: "Button Text",
        buttonLink: "Button Link",
        subButtonText: "Sub Button Text",
        subButtonLink: "Sub Button Link"
    }
    /** 季節活動1~4 選擇器 */
    /** 標籤 */
    var homeadTab = document.querySelectorAll(".cubre-m-indexBoxTab__btn.swiper-slide p")[index];
    /** 圖片 */
    var homeadImg = document.querySelectorAll(".cubre-m-indexBoxTab__container .cubre-m-indexGraphic__pic>img")[index];
    /** 主標題 */
    var homeadMainText = document.querySelectorAll(".cubre-m-indexBoxTab__container .cubre-m-indexGraphic__title")[index];
    /** 副標題 */
    var homeadSubText = document.querySelectorAll(".cubre-m-indexBoxTab__container .cubre-m-indexGraphic__text")[index];
    /** 主按鈕 */
    var homeadButton = document.querySelectorAll(".cubre-m-indexBoxTab__container a#lnk_ButtonLink1")[index];
    /** 次按鈕 */
    var homeadSubBbutton = document.querySelectorAll(".cubre-m-indexBoxTab__container a#lnk_ButtonLink2")[subBtnIdx];
    /** 取得物件裡對應的offer */
    var replacedOfferHtml = newWebOffers[mbox][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
    var offer = JSON.parse(replacedOfferHtml);
    /** 置換按鈕及防呆機制 */
    if (homeadButton && offer[offerKeyName.buttonLink] && offer[offerKeyName.buttomText]) {
        var replaceLink = getReplaceLink(offer[offerKeyName.buttonLink], mbox);
        homeadButton.href = replaceLink;
        homeadButton.innerText = offer[offerKeyName.buttomText];
    }
    /** 置換主標題及防呆機制 */
    homeadMainText && offer[offerKeyName.titleLine] ? homeadMainText.innerText = offer[offerKeyName.titleLine] : null;
    /** 置換副標題及防呆機制 */
    homeadSubText && offer[offerKeyName.descriptionLine] ? homeadSubText.innerText = offer[offerKeyName.descriptionLine] : null;
    /** 置換標籤及防呆機制 */
    homeadTab && offer[offerKeyName.tabText] ? homeadTab.innerText = offer[offerKeyName.tabText] : null;
    /** 置換圖片及防呆機制 */
    homeadImg && offer[offerKeyName.image] ? homeadImg.src = offer[offerKeyName.image] : null;
    /** 如果有副按鈕，置換副按鈕 */
    if (homeadSubBbutton && subBtnIdx !== null && offer[offerKeyName.subButtonText] && offer[offerKeyName.subButtonLink]) { //如果有副按鈕，置換副按鈕
        replaceLink = getReplaceLink(offer[offerKeyName.subButtonLink], mbox);
        homeadSubBbutton.innerText = offer[offerKeyName.subButtonText];
        homeadSubBbutton.href = replaceLink;
    } else if (offer[offerKeyName.subButtonText] && offer[offerKeyName.subButtonLink]) {
        console.log(mbox + " has " + offerKeyName.subButtonText + "/" + offerKeyName.subButtonLink + ",But No Element Found!");
    }

}


/**
 * 取得活動來置換活動位置
 * @param {*} eventNumber 取得活動數量 目前都以 8 個為主
 * @param {*} mboxOffer mbox 活動排序的設定
 */
function getEvents(eventNumber, mboxOffer) {
    /** 先重置一次陣列 */
    eventArray = [];
    /** 主標題排列的陣列 */
    var mainTitleArray = [];
    /** 副標題排列的陣列 */
    var subTitleArray = [];
    /** 重新抓一次所有活動 */
    container = document.querySelector("body > div.cubre-o-container > main > article > div > div.cubre-m-tab__container > div.cubre-m-tab__content.is-active > div > div > div > div.cubre-o-filter__result > div:nth-child(3)");
    for (i = 0; i < eventNumber; i++) {
        /** 可能現有的活動少於8個 或設定的 */
        if (container.children[i]) {
            eventArray.push(container.children[i]);
        }
    }
    /** 時間排序 */
    if (mboxOffer["Time Sort"].toLowerCase() == "true") {
        /** 預設 0 是利用活動開始時間來排順序 */
        var timeArrangeType = 0;
        /** 如果為"true" 則改為 1 利用活動結束時間排順序 */
        if (mboxOffer["End Time Sort"].toLowerCase() == "true") {
            timeArrangeType = 1;
        }
        /** 基礎時間排序 */
        eventArray.sort(function (a, b) {
            try {
                if (a.querySelector(".cubre-m-eventCard__date") && b.querySelector(".cubre-m-eventCard__date")) {
                    /** timeArrangeType 0 為開始時間 、 1 為結束時間 */
                    var aTime = a.querySelector(".cubre-m-eventCard__date").innerText.split("~")[timeArrangeType];
                    var bTime = b.querySelector(".cubre-m-eventCard__date").innerText.split("~")[timeArrangeType];
                    return new Date(aTime) - new Date(bTime);
                } else {
                    return 0;
                }
            } catch (e) {
                console.log(e);
                /** 如果出錯 回傳 0 保持原狀 */
                return 0;
            }
        })
        /** 第二個時間排序 */
        if (mboxOffer["Compare All Time"].toLowerCase() != "false") {
            eventArray.sort(function (a, b) {
                try {
                    if (a.querySelector(".cubre-m-eventCard__date") && b.querySelector(".cubre-m-eventCard__date")) {
                        /** timeArrangeType 0 為開始時間 、 1 為結束時間 */
                        var aTime = a.querySelector(".cubre-m-eventCard__date").innerText.split("~")[timeArrangeType];
                        var bTime = b.querySelector(".cubre-m-eventCard__date").innerText.split("~")[timeArrangeType];
                        /** 當 sort 的前者與後者相同時 比對第二個時間 */
                        if (aTime == bTime) {
                            /** 原本比對 1 的話，接著比對 0 */
                            /** 原本比對 0 的話，舊比對 1 */
                            var doubleCompareA = a.querySelector(".cubre-m-eventCard__date").innerText.split("~")[Math.abs(timeArrangeType - 1)];
                            var doubleCompareB = b.querySelector(".cubre-m-eventCard__date").innerText.split("~")[Math.abs(timeArrangeType - 1)];
                            return new Date(doubleCompareA) - new Date(doubleCompareB);
                        }
                    } else {
                        return 0;
                    }
                } catch (e) {
                    console.log(e);
                    /** 如果出錯 回傳 0 保持原狀 */
                    return 0;
                }
            })
        }
        /** 是否由最新排到舊，預設為true，如果是 false 的話，就倒過來，由舊到新 */
        if (mboxOffer["New to Old Sort"].toLowerCase() == "false") {
            eventArray.reverse();
        }
        /** 上方排序結束後 執行排序 */
        eventArray.forEach(event => {
            container.insertBefore(event, container.firstChild);
        });
        /** 更新 eventArray 抓取更新的活動排序 */
        eventArray = [];
        for (i = 0; i < eventNumber; i++) {
            if (container.children[i]) {
                eventArray.push(container.children[i]);
            }
        }
    }
    /** 副標題排序 */
    if (mboxOffer["Description Keyword"] != "") {
        /** 抓取副標題吻合的元素 並放入新物件裡 */
        subTitleArray = keyWordSearch(mboxOffer["Description Keyword"], ".cubre-m-eventCard__text", eventArray)
        try {
            /** 利用新物件 置換副標題順序 */
            subTitleArray.forEach(event => {
                container.insertBefore(event, container.firstChild);
            })
            /** 如果副標題有換順序 更新所有順序後 讓主標題重新抓順序 */
            eventArray = [];
            for (i = 0; i < eventNumber; i++) {
                if (container.children[i]) {
                    eventArray.push(container.children[i]);
                }
            }
        } catch (e) {
            console.log("Description Keyword : ", e);
        }
    }
    /** [最主要排序]最後執行，主標題排序 */
    if (mboxOffer["Title Keyword"] != "") {
        /** 抓取主標題吻合的元素 並放入新物件裡 */
        mainTitleArray = keyWordSearch(mboxOffer["Title Keyword"], ".cubre-m-eventCard__title", eventArray);
        try {
            /** 利用新物件 置換副標題順序 */
            mainTitleArray.forEach(event => {
                container.insertBefore(event, container.firstChild);
            })
        } catch (e) {
            console.log("Title Keyword : ", e);
        }
    }
}


/**
 * 搜尋關鍵字
 * @param {*} compareWord 關鍵字
 * @param {*} selectorString 搜尋的位置
 * @param {*} events 被搜尋的陣列 
 * @returns 
 */
function keyWordSearch(compareWord, selectorString, events) {
    /** 配對成功的會放進此物件 方便之後置換 */
    var newTitleArray = [];
    try {
        /** 先切割要比對的字串 */
        var titleKeyWord = compareWord.split("#");
        /** 一個一個字串配對 */
        titleKeyWord.forEach(word => {
            /** 所有的主/副標題 */
            events.forEach((event, index, array) => {
                /** 主/副標題位置 */
                var eventTitle = event.querySelector(selectorString);
                if (eventTitle.innerText.includes(word)) {
                    newTitleArray.unshift(event);
                }
            })
        })
        /** 回傳配對成功的陣列 */
    } catch (e) {
        console.log("keyWordSearch : ", e);
        newTitleArray = [];
    }
    return newTitleArray;
}
/**
 * 熱門 Hint 的置換函式
 * @param {*} offer 傳入要置換的 offer 內容
 * @param {*} position 函示位置
 */
function hintButtonTextChange(offer, position = "") {
    try {
        /** 重新抓一次 熱門 Hint */
        var hintButtonSelector = document.querySelectorAll("div.cubre-m-tab__container > div.cubre-m-tab__content.is-active div.cubre-o-formRow__content > div .cubre-o-formBox__item > p > a");
        /** 開始置換內容 */
        var buttonTextArr = offer["Button Text"].split("#")
        hintButtonSelector.forEach((a, index) => {
            if (buttonTextArr[index]) {
                a.innerText = buttonTextArr[index];
            }
        })
    } catch (e) {
        console.log(position + " hintButtonTextChange : ", e);
    }
}

/**
 * 活動置換監聽器 搭配 getEvent 來置換活動順序
 * @param {*} mbox mbox 名稱
 * @param {*} offer offer 內容 置換的 config 設定
 * @param {*} position 活動位置
 */
function activitySort(mbox, offer, position = "") {
    try {
        /** 這邊要先去 Disconnect 原本的 Observer 監聽器 不然會一直重複執行 */
        if (observerObject[mbox]) {
            observerObject[mbox].disconnect();
        }
        /** 執行置換程式 */
        getEvents(8, offer);
        /** [注意] 這邊需要重新抓一次 活動的細項分類區塊 因為 observer 監聽器的關係*/
        var ActivityCategory = document.querySelectorAll("body > div.cubre-o-container > main > article > div > div.cubre-m-tab__container > div.cubre-m-tab__content.is-active > div > div > div > div.cubre-o-filter__info > div > div:nth-child(2) > div");
        var observerDiv = ActivityCategory[0];
        /** 開啟 信用卡活動細項分類區塊的監聽 */
        var observer = new MutationObserver(function () {
            console.log(position + " List Changed AT Retrigger!");
            getEvents(8, offer);
        });
        /** 將 observer監聽器 放進物件裡 方便以後暫停及修改 */
        observerObject[mbox] = observer;
        observerObject[mbox].observe(observerDiv, {
            subtree: true,
            attribute: true,
            childList: true
        })
    } catch (e) {
        console.log(position + " activitySort : ", e);
    }
}

/**
 * [新官網] 活動專區第一次進入會先根據頁面位置執行mbox的活動換位置 
 * 剩餘的活動綁定事件 根據點擊的活動分類 給予活動置換
 * @param {*} mbox 目前的 mbox
 * @param {*} offer mbox 對應到的 offer
 * @param {*} tabOrder 主要 6 個分類 根據 Index 抓取分類的標籤並設點擊事件 預設 null
 */
function ActivityFirstReplace(mbox, offer, tabOrder = null) {
    /** 網址都一樣 但是用 # 來分類種類 所以需要抓去 第一次載入畫面的 # */
    var currentPage = document.URL.toUpperCase().split("#")[1];
    /** # 後面可能會有 & 放其他參數 但這邊都統一過濾掉 方便比對 */
    currentPage = currentPage ? currentPage.split("&")[0] : "";
    /** 上方 6 大活動分類標籤按鈕 會用 Index 0 ~ 6 來抓取 */
    var categoryTab = document.querySelectorAll("body > div.cubre-o-container > main > article > div > div.cubre-m-tab__nav.swiper.cubre-u-mB-0.swiper-container-initialized.swiper-container-horizontal.swiper-container-free-mode.is-pageEnd > div > a");
    /** 當有給數字 代表要設置的按鈕 Index */
    if (tabOrder != null && tabOrder != undefined) {
        /** 為上方每個 主分類標籤 註冊點擊事件 */
        categoryTab[tabOrder].addEventListener("click", function () {
            switch (tabOrder) {
                /** 信用卡 */
                case 0:
                    /** 置換活動位置 mbox */
                    if (mbox == "Activity_Card2") {
                        activitySort(mbox, offer, "信用卡");
                    /** 熱門 Hint 置換 */
                    } else if (mbox == "Activity_Card1") {
                        hintButtonTextChange(offer, "信用卡");
                    }
                    break;
                /** 數位服務 */
                case 1:
                    /** 置換活動位置 mbox */
                    if (mbox == "Activity_Digital2") {
                        activitySort(mbox, offer, "數位服務");
                    /** 熱門 Hint 置換 */
                    } else if (mbox == "Activity_Digital1") {
                        hintButtonTextChange(offer, "數位服務");
                    }
                    break;
                /** 貸款 */
                case 2:
                    /** 置換活動位置 mbox */
                    if (mbox == "Activity_Loan2") {
                        activitySort(mbox, offer, "貸款");
                    /** 熱門 Hint 置換 */
                    } else if (mbox == "Activity_Loan1") {
                        hintButtonTextChange(offer, "貸款");
                    }
                    break;
                /** 投資 */
                case 3:
                    /** 置換活動位置 mbox */
                    if (mbox == "Activity_Invest2") {
                        activitySort(mbox, offer, "投資");
                    /** 熱門 Hint 置換 */
                    } else if (mbox == "Activity_Invest1") {
                        hintButtonTextChange(offer, "投資");
                    }
                    break;
                /** 存款 */
                case 4:
                    /** 置換活動位置 mbox */
                    if (mbox == "Activity_Deposite2") {
                        activitySort(mbox, offer, "存款");
                    /** 熱門 Hint 置換 */
                    } else if (mbox == "Activity_Deposite1") {
                        hintButtonTextChange(offer, "存款");
                    }
                    break;
                /** 保險 */
                case 5:
                    /** 置換活動位置 mbox */
                    if (mbox == "Activity_Insurance2") {
                        activitySort(mbox, offer, "保險");
                    /** 熱門 Hint 置換 */
                    } else if (mbox == "Activity_Insurance1") {
                        hintButtonTextChange(offer, "保險");
                    }
                    break;
            }
        })
    }
    /** 因為當程式第一次正常執行後 活動專區順序換完後 會被前端程式再換回來 所以等前端程式執行完 再執行這邊的程式 */
    var firstObserser = new MutationObserver(function (mutations) {
        /** 最一開始頁面的置換 */
        /** 當現在的頁面搭配到對應的Mbox時執行 */
        switch (currentPage) {
            case "CATEGORY=DIGITAL%20SERVICE":
                /** 頁面配對後 要配對目前的 mbox 是否頁面的對應 mbox */
                if (mbox == "Activity_Digital1" || mbox == "Activity_Digital2") {
                    console.log(mbox);
                    /** 都配對成功後 各別 mbox 有各別要執行的程式 */
                    if (mbox == "Activity_Digital2") {
                        activitySort(mbox, offer, "首次數位服務");
                    } else if (mbox == "Activity_Digital1") {
                        hintButtonTextChange(offer, "首次數位服務");
                    }
                }
                break;
            case "CATEGORY=LOAN":
                /** 頁面配對後 要配對目前的 mbox 是否頁面的對應 mbox */
                if (mbox == "Activity_Loan1" || mbox == "Activity_Loan2") {
                    console.log(mbox);
                    /** 都配對成功後 各別 mbox 有各別要執行的程式 */
                    if (mbox == "Activity_Loan2") {
                        activitySort(mbox, offer, "首次貸款");
                    } else if (mbox == "Activity_Loan1") {
                        hintButtonTextChange(offer, "首次貸款");
                    }
                }
                break;
            case "CATEGORY=INVEST":
                /** 頁面配對後 要配對目前的 mbox 是否頁面的對應 mbox */
                if (mbox == "Activity_Invest1" || mbox == "Activity_Invest2") {
                    console.log(mbox);
                    /** 都配對成功後 各別 mbox 有各別要執行的程式 */
                    if (mbox == "Activity_Invest2") {
                        activitySort(mbox, offer, "首次投資");
                    } else if (mbox == "Activity_Invest1") {
                        hintButtonTextChange(offer, "首次投資");
                    }
                }
                break;
            case "CATEGORY=DEPOSIT":
                /** 頁面配對後 要配對目前的 mbox 是否頁面的對應 mbox */
                if (mbox == "Activity_Deposite1" || mbox == "Activity_Deposite2") {
                    console.log(mbox);
                    /** 都配對成功後 各別 mbox 有各別要執行的程式 */
                    if (mbox == "Activity_Deposite2") {
                        activitySort(mbox, offer, "首次存款");
                    } else if (mbox == "Activity_Deposite1") {
                        hintButtonTextChange(offer, "首次存款");
                    }
                }
                break;
            case "CATEGORY=INSURANCE":
                /** 頁面配對後 要配對目前的 mbox 是否頁面的對應 mbox */
                if (mbox == "Activity_Insurance1" || mbox == "Activity_Insurance2") {
                    console.log(mbox);
                    /** 都配對成功後 各別 mbox 有各別要執行的程式 */
                    if (mbox == "Activity_Insurance2") {
                        activitySort(mbox, offer, "首次保險");
                    } else if (mbox == "Activity_Insurance1") {
                        hintButtonTextChange(offer, "首次保險");
                    }
                }
                break;
            case "CATEGORY=CREDIT%20CARD":
            default:
                /** 當沒有 # 參數時 會面會導到 信用卡頁面 所以 Default 是信用卡 */
                /** 頁面配對後 要配對目前的 mbox 是否頁面的對應 mbox */
                if (mbox == "Activity_Card1" || mbox == "Activity_Card2") {
                    console.log(mbox);
                    /** 都配對成功後 各別 mbox 有各別要執行的程式 */
                    if (mbox == "Activity_Card2") {
                        activitySort(mbox, offer, "首次信用卡");
                    } else if (mbox == "Activity_Card1") {
                        hintButtonTextChange(offer, "首次信用卡");
                    }
                }
        }
        /** 這邊需要暫停 會無限的換順序 */
        firstObserser.disconnect();
    })
    var mainArea = document.querySelector("body > div.cubre-o-container > main > article > div > div.cubre-m-tab__container > div.cubre-m-tab__content.is-active > div > div > div > div.cubre-o-filter__result > div:nth-child(3)");
    firstObserser.observe(mainArea, {
        subtree: true,
        attribute: true,
        childList: true
    })

}

/**
 * 置換offer的函式，利用mbox名稱判斷
 * @param {*} replaceMboxName mbox的名稱
 */
function replaceJS(replaceMboxName) {
    console.log("replaceJS:" + replaceMboxName);
    switch (replaceMboxName) {
        /** [新官網] 開始使用mbox的offers，利用newWebOffers物件來判斷offer並取用 */
        /** [新官網] 活動專區 */
        // ------------------ Start -------- ----------
        case "Activity_Card1": // 信用卡
        case "Activity_Card2": // 信用卡
            if (!isEmpty(newWebOffers[replaceMboxName])) {
                var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                var offer = JSON.parse(replacedOfferHtml);
                ActivityFirstReplace(replaceMboxName, offer, 0);
            }
            break;
        case "Activity_Digital1": // 數位服務
        case "Activity_Digital2": // 數位服務
            if (!isEmpty(newWebOffers[replaceMboxName])) {
                var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                var offer = JSON.parse(replacedOfferHtml);
                ActivityFirstReplace(replaceMboxName, offer, 1);
            }
            break;
        case "Activity_Loan1": // 貸款
        case "Activity_Loan2": // 貸款
            if (!isEmpty(newWebOffers[replaceMboxName])) {
                var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                var offer = JSON.parse(replacedOfferHtml);
                ActivityFirstReplace(replaceMboxName, offer, 2);
            }
            break;
        case "Activity_Invest1": // 投資
        case "Activity_Invest2": // 投資
            if (!isEmpty(newWebOffers[replaceMboxName])) {
                var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                var offer = JSON.parse(replacedOfferHtml);
                ActivityFirstReplace(replaceMboxName, offer, 3);
            }
            break;
        case "Activity_Deposite1": // 存款
        case "Activity_Deposite2": // 存款
            if (!isEmpty(newWebOffers[replaceMboxName])) {
                var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                var offer = JSON.parse(replacedOfferHtml);
                ActivityFirstReplace(replaceMboxName, offer, 4);
            }
            break;
        case "Activity_Insurance1": // 保險
        case "Activity_Insurance2": // 保險
            if (!isEmpty(newWebOffers[replaceMboxName])) {
                var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                var offer = JSON.parse(replacedOfferHtml);
                ActivityFirstReplace(replaceMboxName, offer, 5);
            }
            break;
        // ------------------ End ------------------

        /** [新官網] 首頁 */
        // ------------------ Start ------------------
        // 首頁 歡迎語 置換
        case "homewelcome":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                var offerKeyName = {
                    titleLine: "Title Line",
                    descriptionLine: "Description Line"
                }
                /** 用try catch防止其他錯誤 */
                try {
                    var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                    var offer = JSON.parse(replacedOfferHtml);
                    var mainTitle = document.querySelector(".cubre-a-kvTitle.-index");
                    var subTitle = document.querySelector(".cubre-a-kvTitle.-indexSub");
                    /** 置換主標題及防呆機制 */
                    mainTitle && offer[offerKeyName.titleLine] ? mainTitle.innerText = offer[offerKeyName.titleLine] : null;
                    /** 置換副標題及防呆機制 */
                    subTitle && offer[offerKeyName.descriptionLine] ? subTitle.innerText = offer[offerKeyName.descriptionLine] : null;
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 導覽列 Header 搜尋 Bar Hint 置換
        case "homesearch2":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                var offerKeyName = {
                    buttonText: "Button Text",
                    buttonLink: "Button Link",
                    hintText: "Hint Text"
                }
                /** 用try catch防止其他錯誤 */
                try {
                    var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                    var offer = JSON.parse(replacedOfferHtml);
                    var placeholderText = document.getElementById("searchBox-header");
                    var offerButton = document.querySelectorAll(".cubre-o-search.-header .cubre-a-searchLink.-btn")[0];
                    /** 置換熱門按鈕及防呆機制 */
                    if (offer[offerKeyName.buttonLink] && offer[offerKeyName.buttonText] && offerButton) {
                        var replaceLink = addLinkParams(offer[offerKeyName.buttonLink], "熱門推薦", "AT", offer[offerKeyName.buttonText], "homesearch2");
                        offerButton.innerText = offer[offerKeyName.buttonText];
                        offerButton.href = replaceLink;
                    }
                    /** 置換Placeholder及防呆機制 */
                    placeholderText && offer[offerKeyName.hintText] ? placeholderText.placeholder = offer[offerKeyName.hintText] : null;
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 搜尋 Bar Hint 置換
        case "homesearch1":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                var offerKeyName = {
                    buttonText: "Button Text",
                    buttonLink: "Button Link",
                    hintText: "Hint Text"
                }
                /** 用try catch防止其他錯誤 */
                try {
                    var replacedOfferHtml = newWebOffers[replaceMboxName][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, ""); //取得物件裡對應的offer
                    var offer = JSON.parse(replacedOfferHtml);
                    var offerButton = document.querySelectorAll(".cubre-o-indexKv__search .cubre-a-searchLink.-btn")[0];
                    var placeholderText = document.getElementById("searchBox");
                    /** 置換熱門按鈕及防呆機制 */
                    if (offerButton && offer[offerKeyName.buttonLink] && offer[offerKeyName.buttonText]) {
                        var replaceLink = addLinkParams(offer[offerKeyName.buttonLink], "熱門推薦", "AT", offer[offerKeyName.buttonText], "homesearch1");
                        offerButton.innerText = offer[offerKeyName.buttonText];
                        offerButton.href = replaceLink;
                    }
                    /** 置換Placeholder及防呆機制 */
                    placeholderText && offer[offerKeyName.hintText] ? placeholderText.placeholder = offer[offerKeyName.hintText] : null;
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 數位服務1 置換
        case "homefunction1":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeFunction(replaceMboxName, 0);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 數位服務2 置換
        case "homefunction2":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeFunction(replaceMboxName, 1, 0);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 數位服務3 置換
        case "homefunction3":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeFunction(replaceMboxName, 2, 1);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 數位服務4 置換
        case "homefunction4":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeFunction(replaceMboxName, 3, 2);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 季節活動1 置換
        case "homead1":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeAd(replaceMboxName, 0);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 季節活動2 置換
        case "homead2":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeAd(replaceMboxName, 1, 0);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 季節活動3 置換
        case "homead3":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeAd(replaceMboxName, 2, 1);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // 首頁 季節活動4 置換
        case "homead4":
            if (!isEmpty(newWebOffers[replaceMboxName])) { //防呆機制，確定mbox有offer再置換。
                /** 用try catch防止其他錯誤 */
                try {
                    replacedHomeAd(replaceMboxName, 3, 2);
                } catch (e) {
                    console.log(e);
                }
            } else {
                console.log(replaceMboxName, "有mbox但沒offer"); //不太可能進來，如果offer為【空】replaceJS不會被觸發
            }
            break;
        // ------------------ End ------------------
        case "webproduct1":
            for (var i = 0; i < offers.length; i++) {
                if (offers[i] != undefined && offers[i][0] != undefined) {
                    try {
                        var replacedOfferhtml = offers[i][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
                        var offer = JSON.parse(replacedOfferhtml);
                        var replaceLink = getReplaceLink(offer["Button Link"], "webproduct1");
                        //console.log("replace i="+i+" with replacelink " + replaceLink);
                        var bannerContent = offer["Banner Content"] || "";
                        var titleposition = offer["Typesetting"];
                        if (titleposition != undefined) {
                            if (titleposition == "center") {
                                removeClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-right');
                                removeClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-left');
                                addClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-center');
                            } else if (titleposition == "right") {
                                removeClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-center');
                                removeClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-left');
                                addClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-right');
                            } else if (titleposition == "left") {
                                removeClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-center');
                                removeClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-right');
                                addClass(document.querySelectorAll("#index-carousel .slides .content")[i], 'go-left');
                            }
                        }
                        var replaceTitle = offer["Banner Title"] || "";
                        document.querySelectorAll("#index-carousel .slides a")[i].href = replaceLink;
                        document.querySelectorAll("#index-carousel .slides .content")[i].innerHTML = '<h2><p>' + replaceTitle + '</p></h2><p><p>' + bannerContent + '</p></p><a href="' + replaceLink + '" enclosing-tag="creditcardindexbanner-component" title="' + replaceTitle + '" class="btn btn-important btn-large" id="lnk_creditcardindexbanner-component_BannerLink_' + replaceTitle + '>' + offer["Button Text"] + '</a>';
                        document.querySelectorAll("#index-carousel .slides img")[i].src = offer["Banner Image"];
                    } catch (e) {
                        console.log(e);
                    }
                }
            }
            break;
        //基金． 投資首頁
        case "webfundhome1":
            // 關閉重整套件
            window.removeEventListener('resize', picturefillBackground, false);
            var replacedOfferhtml = offers[0][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
            var offer = JSON.parse(replacedOfferhtml);
            if (detectMob()) {
                var replaceLink = getReplaceLink(offer["Mobile Button Link"], "webfundhome1");
                var buttonContent = offer["Mobile Button Alt"] || "";
                if (offers[0] != undefined && offers[0][0] != undefined) {
                    try {
                        var imageurl = 'url("' + offer["Mobile Banner Image"] + '")';
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].href = replaceLink;
                        document.querySelectorAll('.cubinvest-c-banner__background.picturefill-background')[0].style.backgroundImage = imageurl
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].innerHTML = buttonContent;
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[0].innerHTML = offer["Mobile Banner Title"] || "";
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[1].innerHTML = offer["Mobile Banner Content"] || "";
                    } catch (e) {
                        console.log(e);
                    }
                }
            } else {
                var replaceLink = getReplaceLink(offer["PC Button Link"], "webfundhome1");
                var buttonContent = offer["PC Button Alt"] || "";
                if (offers[0] != undefined && offers[0][0] != undefined) {
                    try {
                        var imageurl = 'url("' + offer["PC Banner Image"] + '")';
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].href = replaceLink;
                        document.querySelectorAll('.cubinvest-c-banner__background.picturefill-background')[0].style.backgroundImage = imageurl
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].innerHTML = buttonContent;
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[0].innerHTML = offer["PC Banner Title"] || "";
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[1].innerHTML = offer["PC Banner Content"] || "";
                    } catch (e) {
                        console.log(e);
                    }
                }
            }


            break;
        // 基金_話題商品
        case "webfundproduct1":
            // 關閉重整套件
            window.removeEventListener('resize', picturefillBackground, false);
            var replacedOfferhtml = offers[0][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
            var offer = JSON.parse(replacedOfferhtml);
            if (detectMob()) {
                var replaceLink = getReplaceLink(offer["Mobile Button Link"], "webfundproduct1");
                var buttonContent = offer["Mobile Button Alt"] || "";
                if (offers[0] != undefined && offers[0][0] != undefined) {
                    try {
                        var imageurl = 'url("' + offer["Mobile Banner Image"] + '")';
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].href = replaceLink;
                        document.querySelectorAll('.cubinvest-c-banner__background.picturefill-background')[0].style.backgroundImage = imageurl
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].innerHTML = buttonContent;
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[0].innerHTML = offer["Mobile Banner Title"] || "";
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[1].innerHTML = offer["Mobile Banner Content"] || "";

                    } catch (e) {
                        console.log(e);
                    }
                }
            } else {
                var replaceLink = getReplaceLink(offer["PC Button Link"], "webfundproduct1");
                var buttonContent = offer["PC Button Alt"] || "";
                if (offers[0] != undefined && offers[0][0] != undefined) {
                    try {
                        var imageurl = 'url("' + offer["PC Banner Image"] + '")';
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].href = replaceLink;
                        document.querySelectorAll('.cubinvest-c-banner__background.picturefill-background')[0].style.backgroundImage = imageurl
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].innerHTML = buttonContent;
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[0].innerHTML = offer["PC Banner Title"] || "";
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[1].innerHTML = offer["PC Banner Content"] || "";

                    } catch (e) {
                        console.log(e);
                    }
                }
            }
            break;
        //財富管理首頁
        case "webwealthhome1":
            // 關閉重整套件
            window.removeEventListener('resize', picturefillBackground, false);
            var replacedOfferhtml = offers[0][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
            var offer = JSON.parse(replacedOfferhtml);
            if (detectMob()) {
                var replaceLink = getReplaceLink(offer["Mobile Button Link"], "webwealthhome1");
                var buttonContent = offer["Mobile Button Alt"] || "";
                if (offers[0] != undefined && offers[0][0] != undefined) {
                    try {
                        var imageurl = 'url("' + offer["Mobile Banner Image"] + '")';
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].href = replaceLink;
                        document.querySelectorAll('.cubinvest-c-banner__background.picturefill-background')[0].style.backgroundImage = imageurl
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].innerHTML = buttonContent;
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[0].innerHTML = offer["Mobile Banner Title"] || "";
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[1].innerHTML = offer["Mobile Banner Content"] || "";
                    } catch (e) {
                        console.log(e);
                    }
                }
            } else {
                var replaceLink = getReplaceLink(offer["PC Button Link"], "webwealthhome1");
                var buttonContent = offer["PC Button Alt"] || "";
                if (offers[0] != undefined && offers[0][0] != undefined) {
                    try {
                        var imageurl = 'url("' + offer["PC Banner Image"] + '")';
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].href = replaceLink;
                        document.querySelectorAll('.cubinvest-c-banner__background.picturefill-background')[0].style.backgroundImage = imageurl
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 a')[0].innerHTML = buttonContent;
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[0].innerHTML = offer["PC Banner Title"] || "";
                        document.querySelectorAll('#layout_0_main_0_RepBanner_Div_Position_0 span')[1].innerHTML = offer["PC Banner Content"] || "";
                    } catch (e) {
                        console.log(e);
                    }
                }
            }
            break;
        case "mwebproduct1":
            for (var i = 0; i < offers.length; i++) {
                if (offers[i] != undefined && offers[i][0] != undefined) {
                    try {
                        var lastIndex = document.querySelectorAll('[data-bxslider="true"] li').length - 1;
                        var replacedOfferhtml = offers[i][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
                        var offer = JSON.parse(replacedOfferhtml);
                        //console.log("replace i=0 with replacelink " + offer["Button Link"]);
                        var replaceLink = getReplaceLink(offer["Button Link"], "mwebproduct1");
                        var bannerContent = offer["Banner Content"] || "";
                        var titlecolor = offer["Color"];
                        if (i == 0) {
                            if (titlecolor != undefined) {
                                if (titlecolor == "green") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--black');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--white');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorBlack');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorWhite');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorGreen');
                                } else if (titlecolor == "black") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--white');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--black');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorGreen');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorWhite');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorBlack');
                                } else if (titlecolor == "white") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--black');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[lastIndex], 'btn--white');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorGreen');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorBlack');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[lastIndex], 'fColorWhite');
                                }
                            }
                            document.querySelectorAll('[data-bxslider="true"] img')[lastIndex].src = offer["Banner Image"];
                            document.querySelectorAll('[data-bxslider="true"] .title')[lastIndex].innerHTML = offer["Banner Title"] || "";
                            document.querySelectorAll('[data-bxslider="true"] .action a')[lastIndex].innerHTML = offer["Button Text"] || "";
                            document.querySelectorAll('[data-bxslider="true"] .action a')[lastIndex].href = replaceLink;
                            document.querySelectorAll('[data-bxslider="true"] .description')[lastIndex].innerHTML = bannerContent;
                        }
                        if (i < lastIndex - 1) {
                            var titleposition = offer["Typesetting"];
                            if (titleposition != undefined) {
                                if (titleposition == "left") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--right');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--bottom');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--left');
                                } else if (titleposition == "right") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--left');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--bottom');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--right');
                                } else if (titleposition == "bottom") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--left');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--right');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[i + 1], 'kvBox__text--bottom');
                                }
                            }
                            if (titlecolor != undefined) {
                                if (titlecolor == "green") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--black');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--white');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorBlack');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorWhite');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorGreen');
                                } else if (titlecolor == "black") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--white');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--black');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorGreen');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorWhite');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorBlack');
                                } else if (titlecolor == "white") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--black');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[i + 1], 'btn--white');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorGreen');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorBlack');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[i + 1], 'fColorWhite');
                                }
                            }
                            document.querySelectorAll('[data-bxslider="true"] img')[i + 1].src = offer["Banner Image"];
                            document.querySelectorAll('[data-bxslider="true"] .title')[i + 1].innerHTML = offer["Banner Title"] || "";
                            document.querySelectorAll('[data-bxslider="true"] .action a')[i + 1].innerHTML = offer["Button Text"] || "";
                            document.querySelectorAll('[data-bxslider="true"] .action a')[i + 1].href = replaceLink;
                            document.querySelectorAll('[data-bxslider="true"] .description')[i + 1].innerHTML = bannerContent;
                        }
                        if (offers.length == lastIndex - 1 && i == offers.length - 1) {
                            var titleposition = offer["Typesetting"];
                            if (titleposition != undefined) {
                                if (titleposition == "left") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--right');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--bottom');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--left');
                                } else if (titleposition == "right") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--left');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--bottom');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--right');
                                } else if (titleposition == "bottom") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--left');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--right');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .kvBox__text')[0], 'kvBox__text--bottom');
                                }
                            }
                            if (titlecolor != undefined) {
                                if (titlecolor == "green") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--black');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--white');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorBlack');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorWhite');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorGreen');
                                } else if (titlecolor == "black") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--white');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--black');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorGreen');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorWhite');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorBlack');
                                } else if (titlecolor == "white") {
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--green');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--black');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .btn')[0], 'btn--white');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorGreen');
                                    removeClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorBlack');
                                    addClass(document.querySelectorAll('[data-bxslider="true"] .text')[0], 'fColorWhite');
                                }
                            }
                            document.querySelectorAll('[data-bxslider="true"] img')[0].src = offer["Banner Image"];
                            document.querySelectorAll('[data-bxslider="true"] .title')[0].innerHTML = offer["Banner Title"] || "";
                            document.querySelectorAll('[data-bxslider="true"] .action a')[0].innerHTML = offer["Button Text"] || "";
                            document.querySelectorAll('[data-bxslider="true"] .action a')[0].href = replaceLink;
                            document.querySelectorAll('[data-bxslider="true"] .description')[0].innerHTML = bannerContent;
                        }
                    }
                    catch (e) {
                        console.log(e);
                    }
                }
            }
            break;
        case "1050forall":
            if (suboffers[0] != undefined && suboffers[0][0] != undefined) {
                try {
                    var replacedOfferhtml = suboffers[0][0].content.replace(/(?:\\[rn]|[\r\n]+)+/g, "");
                    var offer = JSON.parse(replacedOfferhtml);
                    var replaceLink = getReplaceLink(offer["Button Link"], "1050forall");
                    var bannerContent = offer["Banner Content"] || "";
                    //MyBill RWD
                    if (document.querySelectorAll(".ad_mybill .offerBox__image img").length > 0) {
                        document.querySelectorAll(".offerBox__image img")[1].src = offer["Banner Image"];
                        document.querySelectorAll(".offerBox__image .image")[1].href = replaceLink;
                        document.querySelectorAll(".offerBox__image .shareBox__list a")[3].href = "https://www.facebook.com/sharer/sharer.php?u=" + replaceLink;
                        document.querySelectorAll(".offerBox__image .shareBox__list a")[4].href = "http://line.naver.jp/R/msg/text/?" + offer["Banner Title"] + "%0D%0A" + replaceLink;
                        document.querySelectorAll(".offerBox__image .shareBox__list a")[5].href = "mailto:?subject=" + offer["Banner Title"] + "&body=" + replaceLink;
                        document.querySelectorAll(".offerBox__text .title a")[1].href = replaceLink;
                        document.querySelectorAll(".offerBox__text a")[1].innerHTML = offer["Banner Title"] || "";
                        document.querySelectorAll(".offerBox__text .info")[1].innerHTML = bannerContent;
                    }
                    else {
                        document.querySelectorAll(".section__content .offerBox__image img")[0].src = offer["Banner Image"];
                        document.querySelectorAll(".section__content .offerBox__image a")[0].href = replaceLink;
                        document.querySelectorAll(".section__content .offerBox__image .shareBox__list a")[0].href = "https://www.facebook.com/sharer/sharer.php?u=" + replaceLink;
                        document.querySelectorAll(".section__content .offerBox__image .shareBox__list a")[1].href = "http://line.naver.jp/R/msg/text/?" + offer["Banner Title"] + "%0D%0A" + replaceLink;
                        document.querySelectorAll(".section__content .offerBox__image .shareBox__list a")[2].href = "mailto:?subject=" + offer["Banner Title"] + "&body=" + replaceLink;
                        document.querySelectorAll(".section__content .offerBox__text .title a")[0].href = replaceLink;
                        document.querySelectorAll(".section__content .offerBox__text a")[0].innerHTML = offer["Banner Title"] || "";
                        document.querySelectorAll(".section__content .offerBox__text .info")[0].innerHTML = bannerContent;
                    }
                } catch (e) {
                    console.log(e);
                }
            }
            break;
        default:
            break;
    }
}

/** 監聽Target活動，如果有applyOffer就會啟動 */
/** 如果offer為【空】也不會觸發置換 */
document.addEventListener(adobe.target.event.CONTENT_RENDERING_SUCCEEDED, function (e) {
    var tokens = e.detail.responseTokens;
    var mboxname = e.detail.mbox;
    if (isEmpty(tokens)) {
        if (mboxname != "target-global-mbox") {
            if (typeof buildEventAfterDom !== 'undefined') {
                buildEventAfterDom = true;
            }
            var event = new CustomEvent('getalloffersdone', {
                'detail': mboxname
            });
            document.dispatchEvent(event);
            //如果主版位無素材，置換副版位
            if (multipleMbox) {
                adobegetoffer(requestMboxArr[1]);
                multipleMbox = false;
            }
        }
        return;
    }
    var offerslength = offers.length;
    var mboxlength = requestMbox.OFFERNUM;
    if (mboxname == "webproduct3" || mboxname == "1050forall" || mboxname == "webhome2") {
        offerslength = suboffers.length;
        mboxlength = 1;
    }
    if (mboxname != "target-global-mbox" && offerslength < mboxlength) {
        if (offers.length == 1 && !duplicateOffer) {
            replaceJS(mboxname);
        }
        if (usedoffer.indexOf(tokens[0]["activity.id"]) > -1) {
            duplicateOffer = true;
            offers[offerslength - 1] = undefined;
            console.log("Duplicate ID:" + tokens[0]["activity.id"]);
            var event = new CustomEvent('getalloffersdone', {
                'detail': mboxname
            });
            document.dispatchEvent(event); //手動觸發Event
            if (multipleMbox) { // 如果有2個mbox，也取得第2個mbox的offer 
                adobegetoffer(requestMboxArr[1]);
                multipleMbox = false;
            }
        } else {
            if (!duplicateOffer) {
                usedoffer = usedoffer + tokens[0]["activity.id"] + "|";
                useditem = useditem + tokens[0]["offer.id"] + "|";
                adobegetoffer(requestMboxArr[0]);
            }
        }

    } else {
        //主版位取完取副版位
        if (multipleMbox) {
            adobegetoffer(requestMboxArr[1]);
            multipleMbox = false;
        }
        /*檢查最後一個有無重複*/
        if (usedoffer.indexOf(tokens[0]["activity.id"]) > -1) {
            duplicateOffer = true;
            offers[offerslength - 1] = undefined;
            console.log("Duplicate ID:" + tokens[0]["activity.id"]);
        }
        var event = new CustomEvent('getalloffersdone', {
            //console.log("send getalloffersdone event2:"+mboxname);
            'detail': mboxname
        });
        document.dispatchEvent(event); //手動觸發Event
    }
});

/**
 * 利用mbox來取得對應的offer，並存入offer陣列
 * @param {*} requestMbox1 欲取得offer的mbox名稱
 */
function adobegetoffer(requestMbox1) {
    //console.log("adobegetoffer:" + requestMbox1);
    adobe.target.getOffer({
        "mbox": requestMbox1,
        "params": {
            "usedoffer": usedoffer,
            "useditem": useditem
        },
        "success": function (offer1) {
            if (requestMbox1 == "webproduct3" || requestMbox1 == "1050forall" || requestMbox1 == "webhome2") { // 判斷次要offer的名稱，並推進次要offer陣列
                suboffers.push(offer1);
            } else {
                offers.push(offer1);
            }

            /** [新官網] 利用物件的方式來判斷mbox及對應的offer */
            newWebOffers[requestMbox1] = offer1

            /** 需要applyOffer，上方adobe.target.event.CONTENT_RENDERING_SUCCEEDED的監聽才能取得 detail.mbox */
            adobe.target.applyOffer({
                "mbox": requestMbox1,
                "offer": offer1
            });
        },
        /** 錯誤處理 */
        "error": function (status, error) {
            console.log('Error1', status, error);
            var event = new CustomEvent('getalloffersdone', {
                'detail': requestMbox1
            });
            document.dispatchEvent(event); //手動觸發Event
        }
    });
}

/** 定義客製Event */
/** 如果取得到mbox就會手動觸發這個監聽來完成offer置換 */
document.addEventListener('getalloffersdone', function (e) {
    if (document.readyState === "complete" ||
        (document.readyState !== "loading" && !document.documentElement.doScroll)) {
        replaceJS(e.detail);
    } else {
        document.addEventListener("DOMContentLoaded", function (event) {
            replaceJS(e.detail);
        });
    }
});

/** 如果有取得mbox執行取得offer */
/** 原始寫法最多只支援兩個mbox，所以新官網換一個寫法 */
if (requestMbox != undefined) {
    if (requestMbox != "" && requestMbox != undefined) {
        var sendRequest = true;
        if (requestMbox.MBOXNAME == "MYBANKSIDE") {
            if ($('#ad-slide').html() == null) {
                sendRequest = false;
            }
        }
        if (sendRequest) {
            var requestMboxArr = [];
            if (requestMbox.MBOXNAME.indexOf('#') > 0) { //處理多個mbox
                requestMboxArr = requestMbox.MBOXNAME.split("#");
            } else {
                requestMboxArr.push(requestMbox.MBOXNAME);
            }

            if (requestMboxArr.length > 2) { // 這邊判斷如果mbox多於2個的話
                requestMboxArr.forEach(function (mbox, idx) { //直接取得所有的offer
                    adobegetoffer(mbox)
                })
            } else { //如果mbox為1個或2個，維持原本的判斷及程式碼
                adobegetoffer(requestMboxArr[0]);
                if (requestMboxArr.length > 1) { // 2個mbox的話，把multipleMbox設為true
                    multipleMbox = true;
                }
            }
        }
    }
}

</script>
    <script src="/promotion/Promotion/js/blockUI.js?v=c87UpO_PoATfIB5P6U_4syNZRNVpWBT8Dtoxr73QRMQ"></script>
    <script src="/promotion/Promotion/js/ajaxSetup.js?v=r38LfJ9OtBSj-HoYolaTVBgbMrEJqctTJRcKQSBKXsM"></script>
    <script src="/promotion/Promotion/Promotion/js/main.js?v=WaSk5XypNYFAqO3uzRZ2GN1JPNYx44qv-GpQi2Aoe04"></script>

    
<script>
    var IsHotTime = false;
    var authenticationUrl = "/promotion/promotion";
</script>
<script src="/promotion/Promotion/Promotion/js/event.js?v=h1JOt5vEY-xdTXXXjrqEXrpJeurApX_JkoTY03AVLTA"></script>
<script src="/promotion/Promotion/Promotion/js/Browser.js?v=5koA7fMoe8ah6kp1lkEVGusNr2y2ZzP0j2SF_MkC-yk"></script>
<script src="/promotion/Promotion/Promotion/js/nps.js?v=nrSoz-f8gTGzqRwaBp9IoluqmbuTbIbGqQgBZZamc8g"></script>
        <script>
            window.CathayBK.setNPS("https://survey.cathaybk.com.tw/s/wep7R?ssn0={Hash_ID}&ssn6={Device}&ssn7={Browser}&ssn8={System}&ssn9={Session}&ssn10={Version}",
                "8ddc267101282a684ab2f440d7e2b93c9378ac68e7214e4652c04b902dbd103e",
                "/promotion/promotion/CreditCard/NPSLog");
        </script>



<div id="external-player-toast-div"></div><div id="external-player-loading-div"><div></div></div><div id="external-player-button-div"><button style="width: 52px; height: 52px; background-image: url(&quot;data:image/png;base64,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&quot;); visibility: hidden;"></button><button id="external-player-setting-button" title="Ctrl + Alt + E"></button></div></body></html>